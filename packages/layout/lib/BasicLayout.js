"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const a=require("vue"),w=require("ant-design-vue"),Ee=require("ant-design-vue/lib/_util/warning"),o=require("@ant-design-vue/pro-utils"),j=require("@ant-design-vue/pro-provider"),Je=require("./style/index.js"),Qe=require("./locales/index.js"),Xe=require("./utils/getMenuData.js"),Ye=require("@ant-design-vue/route-utils"),Ze=require("./components/Header/index.js"),pe=require("./components/Footer/index.js"),et=require("ant-design-vue/lib/config-provider/context"),tt=require("./utils/useCurrentMenuLayoutProps.js"),at=require("./utils/index.js"),We=require("./components/SiderMenu/index.js"),ut=require("./WrapContent.js"),lt=require("./proLayoutProps.js"),$e=require("./context/RouteContext.js"),ot=require("./components/PageLoading/index.js"),ze=require("./getPageTitle.js"),nt=require("./utils/getBreadcrumbProps.js"),rt=(e,l)=>{var n;return e.headerRender===!1||e.pure?null:a.createVNode(Ze.default,a.mergeProps({matchMenuKeys:l},e,{stylish:(n=e.stylish)==null?void 0:n.header}),null)},it=(e,l)=>{const{pageTitleRender:n}=l,c=ze.getPageTitleInfo(e);if(n===!1)return{title:l.title||"",id:"",pageName:""};if(n){const r=n(e,c.title,c);if(typeof r=="string")return ze.getPageTitleInfo({...c,title:r});Ee(typeof r=="string","pro-layout: ","renderPageTitle return value should be a string")}return c},ct=(e,l,n,c)=>e?l?c:n:0,dt=(e,l)=>{var k,d,v,b;const{layout:n,isMobile:c,selectedKeys:r,openKeys:A,splitMenus:i,suppressSiderWhenMenuEmpty:W,menuRender:T}=e;if(e.menuRender===!1||e.pure)return null;let{menuData:t}=e;if(i&&(A!==!1||n==="mix")&&!c){const[S]=r||l;S?t=((d=(k=e.menuData)==null?void 0:k.find(V=>V.key===S))==null?void 0:d.children)||[]:t=[]}const g=at.clearMenuItem(t||[]);if(g&&(g==null?void 0:g.length)<1&&(i||W))return null;if(n==="top"&&!c)return a.createVNode(We.default,a.mergeProps(e,{matchMenuKeys:l,hide:!0,stylish:(v=e.stylish)==null?void 0:v.sider}),null);const N=a.createVNode(We.default,a.mergeProps(e,{matchMenuKeys:l,menuData:g,stylish:(b=e.stylish)==null?void 0:b.sider}),null);return T?T(e,N):N},st=e=>e.tagsViewRender===!1||e.pure?null:e.tagsViewRender?e.tagsViewRender(e):null,vt=e=>e.footerRender===!1||e.pure?null:e.footerRender?e.footerRender({...e},a.createVNode(pe.default,null,null)):null,mt=a.defineComponent({name:"BasicLayout",inheritAttrs:!1,props:lt.proLayoutProps(),setup(e,{slots:l,attrs:n}){const{getPrefixCls:c,locale:r}=et.useConfigContextInject(),A=a.computed(()=>e.prefixCls??c("pro")),i=a.computed(()=>`${A.value}-basicLayout`),{wrapSSR:W,hashId:T}=Je.useStyle(i),t=j.useProConfigContextInject(),g=o.useMemo(()=>e.siderWidth||256,[()=>e.layout,()=>e.siderWidth]),N=o.useMemo(()=>e.collapsedWidth||64,[()=>e.collapsedWidth]),k=o.useCallback(({id:u,defaultMessage:m,...M})=>{if(e.formatMessage)return e.formatMessage({id:u,defaultMessage:m,...M});const f=Qe.gLocaleObject(r==null?void 0:r.value.locale);return f[u]?f[u]:m},[()=>e.formatMessage,()=>r==null?void 0:r.value]),d=o.useMemo(()=>Xe.default(e.routes||[],e.menu,k.value,e.menuDataRender),[()=>k.value,()=>e.menu,()=>e.menuDataRender,()=>e.routes]),v=o.useMemo(()=>{var u;return Ye.getMatchMenu(((u=e.location)==null?void 0:u.pathname)||"/",d.value.menuData||[],!0)},[()=>(e.location||{}).pathname,()=>d.value.menuData]),b=o.useMemo(()=>Array.from(new Set(v.value.map(u=>u.key||u.path||""))),[()=>v.value]),S=o.useMemo(()=>v.value[v.value.length-1]||{},[()=>v.value]),V=tt.default(S),x=o.useBreakpoint(),s=o.useMemo(()=>(x.value==="sm"||x.value==="xs")&&!e.disableMobile,[()=>x.value,()=>e.disableMobile]),we=a.computed(()=>e.layout!=="top"&&!s.value),[B,F]=o.useMountMergeState(()=>e.defaultCollapsed!==void 0?e.defaultCollapsed:s.value?!0:x.value==="md",{value:e.collapsed===void 0?void 0:a.toRef(e,"collapsed"),onChange:e.onCollapse}),K=a.computed(()=>ct(!!we.value,B.value,g.value,N.value)),y=a.computed(()=>{var u;return o.omit({...e,prefixCls:A.value,siderWidth:g.value,...V.value,formatMessage:k.value,breadcrumb:d.value.breadcrumb,menu:{...e.menu,type:e.siderMenuType||((u=e.menu)==null?void 0:u.type)}},["breadcrumbRender"])}),je=$e.useRouteContextInject(),Fe=a.computed(()=>nt.getBreadcrumbProps({...y.value,breadcrumbRender:e.breadcrumbRender,breadcrumbMap:d.value.breadcrumbMap},e)),G=a.computed(()=>e.isChildrenLayout!==void 0?e.isChildrenLayout:je.value.isChildrenLayout),[O,Ke]=o.useState(!1),[U,Ge]=o.useState(0),$=a.computed(()=>{var u;return it({...y.value,pathname:((u=e.location||{})==null?void 0:u.pathname)||"/",breadcrumbMap:d.value.breadcrumbMap},e)}),_=o.useMemo(()=>e.bgLayoutImgList&&e.bgLayoutImgList.length>0?e.bgLayoutImgList.map(({src:u,...m},M)=>a.createVNode("img",{key:M,src:u,alt:"",style:{position:"absolute",...Object.entries(m).reduce((f,[I,h])=>({...f,[I]:typeof h=="number"?`${h}px`:h}),{})}},null)):null,[()=>e.bgLayoutImgList]),z=a.computed(()=>dt({...y.value,menuData:d.value.menuData,onCollapse:F,isMobile:s.value,collapsed:B.value},b.value)),E=a.computed(()=>rt({...y.value,hasSiderMenu:!!z.value,menuData:d.value.menuData,isMobile:s.value,collapsed:B.value,onCollapse:F},b.value)),Oe=a.computed(()=>st({...y.value,siderWidth:K.value,isMobile:s.value,collapsed:B.value})),J=a.computed(()=>vt({...y.value,isMobile:s.value,collapsed:B.value})),Ue=a.computed(()=>({...y.value,breadcrumb:Fe.value,menuData:d.value.menuData,isMobile:s.value,collapsed:B.value,title:$.value.pageName,pageTitleInfo:$.value,hasSiderMenu:!!z.value,isChildrenLayout:!0,siderWidth:K.value,matchMenus:v.value,matchMenuKeys:b.value,currentMenu:S.value,hasFooter:!!J.value,hasFooterToolbar:O.value,hasPageContainer:U.value,setHasFooterToolbar:Ke,setHasPageContainer:Ge}));$e.useRouteContextProvider(Ue),o.useDocumentTitle($,a.computed(()=>e.title||!1));const _e=o.useMemo(()=>{var u,m,M,f,I,h,C,P,L,R,D,H,q,Q,X,Y,Z,p,ee,te,ae,ue,le,oe,ne,re,ie,ce,de,se,ve,me,ge,fe,he,ye,Me,ke,be,xe,Be,Ie,Te,Se,Ce,Pe,Le,Re,De,He,qe,Ae,Ne,Ve;return e.navTheme==="realDark"&&e.layout!=="mix"||e.navTheme==="dark"&&e.layout!=="mix"||e.layout==="mix"&&s.value&&e.navTheme==="realDark"||e.layout==="mix"&&s.value&&e.navTheme==="dark"?{colorItemBg:((m=(u=e.token)==null?void 0:u.sider)==null?void 0:m.colorMenuBackground)||"#001529",colorSubItemBg:((f=(M=e.token)==null?void 0:M.sider)==null?void 0:f.colorSubMenuBackground)||"#000c17",radiusItem:t.value.token.borderRadiusLG,colorItemBgSelected:((h=(I=e.token)==null?void 0:I.sider)==null?void 0:h.colorBgMenuItemSelected)||((C=t.value.token)==null?void 0:C.colorPrimary),colorItemBgHover:((L=(P=e.token)==null?void 0:P.sider)==null?void 0:L.colorBgMenuItemHover)||"transparent",colorItemBgActive:((D=(R=e.token)==null?void 0:R.sider)==null?void 0:D.colorBgMenuItemActive)||"transparent",colorItemBgSelectedHorizontal:((q=(H=e.token)==null?void 0:H.sider)==null?void 0:q.colorBgMenuItemSelectedHorizontal)||t.value.token.colorPrimary,colorActiveBarWidth:((X=(Q=e.token)==null?void 0:Q.sider)==null?void 0:X.colorTextMenuActiveBarWidth)||0,colorActiveBarHeight:((Z=(Y=e.token)==null?void 0:Y.sider)==null?void 0:Z.colorTextMenuActiveBarHeight)||0,colorActiveBarBorderSize:((ee=(p=e.token)==null?void 0:p.sider)==null?void 0:ee.colorTextMenuActiveBarBorderSize)||0,colorItemText:((ae=(te=e.token)==null?void 0:te.sider)==null?void 0:ae.colorTextMenu)||j.setAlpha((ue=t.value.token)==null?void 0:ue.colorTextLightSolid,.65),colorItemTextHover:((oe=(le=e.token)==null?void 0:le.sider)==null?void 0:oe.colorTextMenuItemHover)||t.value.token.colorTextLightSolid,colorItemTextSelected:((re=(ne=e.token)==null?void 0:ne.sider)==null?void 0:re.colorTextMenuSelected)||t.value.token.colorTextLightSolid}:{colorItemBg:((ce=(ie=t.value.token.layout)==null?void 0:ie.sider)==null?void 0:ce.colorMenuBackground)||"transparent",colorSubItemBg:((se=(de=t.value.token.layout)==null?void 0:de.sider)==null?void 0:se.colorSubMenuBackground)||"transparent",radiusItem:t.value.token.borderRadiusLG,colorItemBgSelected:((me=(ve=t.value.token.layout)==null?void 0:ve.sider)==null?void 0:me.colorBgMenuItemSelected)||((ge=t.value.token)==null?void 0:ge.controlItemBgActive),colorItemBgHover:((he=(fe=t.value.token.layout)==null?void 0:fe.sider)==null?void 0:he.colorBgMenuItemHover)||((ye=t.value.token)==null?void 0:ye.colorBgTextHover),colorItemBgActive:((ke=(Me=t.value.token.layout)==null?void 0:Me.sider)==null?void 0:ke.colorBgMenuItemActive)||((be=t.value.token)==null?void 0:be.colorFillContent),colorItemBgSelectedHorizontal:((Be=(xe=t.value.token.layout)==null?void 0:xe.sider)==null?void 0:Be.colorBgMenuItemSelectedHorizontal)||"transparent",colorActiveBarWidth:((Te=(Ie=t.value.token.layout)==null?void 0:Ie.sider)==null?void 0:Te.colorTextMenuActiveBarWidth)||0,colorActiveBarHeight:((Ce=(Se=t.value.token.layout)==null?void 0:Se.sider)==null?void 0:Ce.colorTextMenuActiveBarHeight)||t.value.token.lineWidthBold,colorActiveBarBorderSize:((Le=(Pe=t.value.token.layout)==null?void 0:Pe.sider)==null?void 0:Le.colorTextMenuActiveBarBorderSize)||t.value.token.lineWidth,colorItemText:((De=(Re=t.value.token.layout)==null?void 0:Re.sider)==null?void 0:De.colorTextMenu)||((He=t.value.token)==null?void 0:He.colorText),colorItemTextHover:((Ae=(qe=t.value.token.layout)==null?void 0:qe.sider)==null?void 0:Ae.colorTextMenuItemHover)||t.value.token.colorText,colorItemTextSelected:((Ve=(Ne=t.value.token.layout)==null?void 0:Ne.sider)==null?void 0:Ve.colorTextMenuSelected)||t.value.token.colorPrimary}},[()=>e.navTheme,()=>s.value,()=>e.layout,()=>e.token,()=>t.value.token]);return()=>{var C;const{fixedSiderbar:u,contentStyle:m,navTheme:M,layout:f,...I}={...e,...V.value},h=o.classNames(n.class,T.value,i.value,{[`screen-${x.value}`]:x.value,[`${i.value}-is-children`]:G.value,[`${i.value}-fix-siderbar`]:u,[`${i.value}-realDark`]:e.navTheme==="realDark",[`${i.value}-${e.layout}`]:e.layout});return W(a.createVNode(a.Fragment,null,[e.pure?(C=l.default)==null?void 0:C.call(l):a.createVNode(w.Layout,{class:h,style:n.style},{default:()=>{var P,L,R;return[_.value&&a.createVNode("div",{class:`${i.value}-bg-list ${T.value}`},[_.value]),a.createVNode(w.ConfigProvider,{theme:{hashed:j.isNeedOpenHash(),token:{controlHeightLG:((L=(P=t.value.token.layout)==null?void 0:P.sider)==null?void 0:L.menuHeight)||((R=t.value.token)==null?void 0:R.controlHeightLG)},components:{Menu:_e.value}}},{default:()=>[z.value]}),a.createVNode(w.Layout,null,{default:()=>{var D,H;return[E.value,Oe.value,a.createVNode(ut.default,a.mergeProps(I,{hasPageContainer:U.value,isChildrenLayout:G.value,hasHeader:!!E.value,prefixCls:i.value,style:m}),{default:()=>{var q;return[e.loading?a.createVNode(ot.default,null,null):(q=l.default)==null?void 0:q.call(l)]}}),J.value,O.value&&a.createVNode("div",{class:`${i.value}-has-footer`,style:{height:"44px",marginBlockStart:`${(H=(D=t.value.token.layout)==null?void 0:D.pageContainer)==null?void 0:H.paddingBlockPageContainerContent}px`}},null)]}})]}})]))}}});exports.default=mt;
