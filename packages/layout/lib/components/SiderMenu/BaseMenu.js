"use strict";var L=Object.defineProperty;var H=(e,t,n)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var N=(e,t,n)=>H(e,typeof t!="symbol"?t+"":t,n);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const l=require("vue"),G=require("ant-design-vue"),_=require("ant-design-vue/lib/menu/src/Menu"),d=require("../../defaultSettings.js"),i=require("@ant-design-vue/pro-utils"),D=require("@ant-design/icons-vue"),z=require("./style/menu.js"),R=require("../../utils/index.js"),q=()=>({..._.menuProps(),defaultCollapsed:{type:Boolean,default:void 0},collapsed:{type:Boolean,default:void 0},isMobile:{type:Boolean,default:void 0},onOpenChange:{type:Function,default:void 0},location:{type:Object,default:void 0},menuData:Array,onCollapse:Function,openKeys:{type:[Boolean,Array],default:void 0},mode:{type:String,default:void 0},navTheme:{type:String,default:d.default.navTheme},layout:{type:String,default:d.default.layout},contentWidth:{type:String,default:d.default.contentWidth},fixedHeader:{type:Boolean,default:d.default.fixedHeader},fixedSiderbar:{type:Boolean,default:d.default.fixedSiderbar},menu:{type:Object,default:()=>d.default.menu},title:{type:[String,Boolean],default:d.default.title},iconfontUrl:{type:String,default:d.default.iconfontUrl},colorPrimary:{type:String,default:d.default.colorPrimary},colorWeak:{type:Boolean,default:d.default.colorWeak},splitMenus:{type:Boolean,default:d.default.splitMenus},suppressSiderWhenMenuEmpty:{type:Boolean,default:d.default.suppressSiderWhenMenuEmpty},siderMenuType:{type:String,default:d.default.siderMenuType},menuProps:{type:Object,default:void 0},menuItemRender:{type:[Object,Function,Boolean],default:void 0},subMenuItemRender:{type:[Object,Function,Boolean],default:void 0},iconPrefixes:String,formatMessage:Function,postMenuData:{type:Function,default:void 0},onSelect:Function});let W=D.createFromIconfontCN({scriptUrl:d.default.iconfontUrl});const w=(e,t="icon-",n)=>{if(!e)return null;if(typeof e=="string"&&e!==""){if(i.isUrl(e)||i.isImg(e))return l.createVNode("img",{width:16,key:e,src:e,alt:"icon",class:n},null);if(e.startsWith(t))return l.createVNode(W,{type:e},null);const o=l.resolveComponent(e);return typeof o=="function"&&l.h(o)}return l.isVNode(e)?e:typeof e=="function"?l.h(e):e},A=e=>e&&typeof e=="string"?e.substring(0,1).toUpperCase():null;class J{constructor(t){N(this,"getNavMenuItems",(t=[],n,o)=>t.map(s=>this.getSubMenuOrItem(s,n,o)).filter(s=>s).flat(1));N(this,"getSubMenuOrItem",(t,n,o)=>{var c,h,S,p,C;const{baseClassName:s,collapsed:r,menu:u,subMenuItemRender:y,iconPrefixes:v,layout:b}=this.props,f=(u==null?void 0:u.type)==="group"&&b!=="top",M=this.getIntlTitle(t),I=t==null?void 0:t.children,a=f&&n===0?"group":void 0;if(Array.isArray(I)&&I.length>0){const $=n===0||f&&n===1,K=$?w((c=t.meta)==null?void 0:c.icon,v,`${s}-icon ${(h=this.props)==null?void 0:h.hashId}`):null,T=r&&$?A(M):null,g=!f||f&&r||!a?M:l.h("div",{class:i.classNames(`${s}-item-title`,(S=this.props)==null?void 0:S.hashId,{[`${s}-item-title-collapsed`]:r,[`${s}-item-title-collapsed-level-${o}`]:r,[`${s}-group-item-title`]:a==="group",[`${s}-item-collapsed-show-title`]:(u==null?void 0:u.collapsedShowTitle)&&r})},[l.h("span",{class:i.classNames(`${s}-item-icon`,(p=this.props)==null?void 0:p.hashId)},!K&&T?T:[K]),l.h("span",{class:i.classNames(`${s}-item-text`,(C=this.props)==null?void 0:C.hashId)},M)]),m=y?y({...t,isUrl:!1},g,this.props):g;if(f&&n===0&&r&&!u.collapsedShowGroupTitle)return this.getNavMenuItems(I,n+1,n);const k=this.getNavMenuItems(I,n+1,f&&n===0&&r?n:n+1);return[{type:a,key:t.key||t.path,...f&&a==="group"?{}:{icon:()=>K||T},label:m,onClick:f?void 0:t.onTitleClick,children:k},f&&n===0?{type:"divider",class:`${s}-divider`,key:(t.key||t.path)+"-group-divider"}:void 0].filter(Boolean)}return{class:`${s}-menu-item`,disabled:t.disabled,key:t.key||t.path,onClick:t.onTitleClick,...this.getMenuItem(t,n,o)}});N(this,"getMenuItem",(t,n,o)=>{var B,U,x,j,F;const{menuItemRender:s,iconPrefixes:r,baseClassName:u,menu:y,layout:v,collapsed:b,location:f={pathname:"/"},onCollapse:M,isMobile:I,menuProps:a}=this.props,c=this.getIntlTitle(t),h=this.conversionPath(t.path||"/"),S=(y==null?void 0:y.type)==="group"&&v!=="top",p=n===0||S&&n===1,C=p?w((B=t.meta)==null?void 0:B.icon,r,`${u}-icon ${(U=this.props)==null?void 0:U.hashId}`):null,$=b&&p?A(c):null,K=i.isUrl(h),g={...t.meta}.target||null,m=g&&"a"||this.RouterLink,k=K||g?{href:t.path,target:g}:{},V={to:{name:t.name,...t.meta}};let P=l.h(l.Fragment,null,[l.h("span",{class:i.classNames(`${u}-item-text`,(x=this.props)==null?void 0:x.hashId)},c)]);if((typeof m!="string"&&m.name==="RouterLink"||typeof m=="string"&&m==="a")&&!(a!=null&&a.onSelect)&&(P=l.h(m,{...k,...m==="a"?{}:V,key:h,class:i.classNames(`${u}-item-title`,(j=this.props)==null?void 0:j.hashId,{[`${u}-item-title-collapsed`]:b,[`${u}-item-title-collapsed-level-${o}`]:b,[`${u}-item-collapsed-show-title`]:(y==null?void 0:y.collapsedShowTitle)&&b})},typeof m=="string"&&m==="a"?l.h("span",{class:i.classNames(`${u}-item-text`,(F=this.props)==null?void 0:F.hashId)},c):()=>{var O;return l.h("span",{class:i.classNames(`${u}-item-text`,(O=this.props)==null?void 0:O.hashId)},c)})),s){const O={...t,isUrl:K,itemPath:h,isMobile:I,replace:h===f.pathname,onClick:()=>M&&M(!0),children:void 0},E=s(O,P,this.props);return{icon:()=>C||$,label:E}}return{icon:()=>C||$,label:P}});N(this,"getIntlTitle",({meta:t})=>{const{menu:n,formatMessage:o}=this.props,{title:s,locale:r}=t;return r&&(n==null?void 0:n.locale)!==!1?o==null?void 0:o({id:r,defaultMessage:s}):s});N(this,"conversionPath",t=>t&&t.startsWith("http")?t:`/${t||""}`.replace(/\/+/g,"/"));this.props=t,this.RouterLink=l.resolveComponent("RouterLink")}}const Q=(e,{layout:t,collapsed:n})=>{let o={};return e&&!n&&["side","mix"].includes(t||"mix")&&(o={openKeys:e}),o},X=l.defineComponent({name:"BaseMenu",inheritAttrs:!1,props:{...q(),matchMenuKeys:{type:Array,default:()=>[]},originCollapsed:{type:Boolean,default:void 0},menuRenderType:{type:String,default:"sider"},stylish:{type:Object,default:()=>({})}},setup(e,{attrs:t}){var I;const n=l.computed(()=>`${e.prefixCls}-base-menu-${e.mode}`),[o,s]=i.useMountMergeState((I=e.menu)==null?void 0:I.defaultOpenAll,{value:l.toRef(e.menu,"defaultOpenAll")}),[r,u]=i.useMountMergeState(()=>{var a;return(a=e.menu)!=null&&a.defaultOpenAll?R.getOpenKeysFromMenuData(e.menuData)||[]:e.openKeys===!1?!1:[]},{value:l.toRef(e,"openKeys"),onChange:e.onOpenChange}),[y,v]=i.useMountMergeState([],{value:l.toRef(e,"selectedKeys"),onChange:e.onSelect?a=>{var c;e.onSelect&&a&&(e.isMobile&&((c=e.onCollapse)==null||c.call(e,!0)),e.onSelect(a))}:e.isMobile?()=>{var a;return(a=e.onCollapse)==null?void 0:a.call(e,!0)}:void 0});i.useEffect(()=>{var a;(a=e.menu)!=null&&a.defaultOpenAll||e.openKeys===!1||e.matchMenuKeys&&(u(e.matchMenuKeys),v(e.matchMenuKeys))},[()=>{var a;return(a=e.matchMenuKeys)==null?void 0:a.join("-")}]),i.useEffect(()=>{var a,c,h,S;if(e.matchMenuKeys&&((a=e.matchMenuKeys)==null?void 0:a.join("-"))!==(y.value||[]).join("-")&&v(e.matchMenuKeys),!o.value&&e.openKeys!==!1&&((c=e.matchMenuKeys)==null?void 0:c.join("-"))!==(r.value||[]).join("-")){let p=e.matchMenuKeys;((h=e.menu)==null?void 0:h.autoClose)===!1&&(p=Array.from(new Set([...e.matchMenuKeys,...r.value||[]]))),u(p)}else(S=e.menu)!=null&&S.ignoreFlatMenu&&o.value?u(R.getOpenKeysFromMenuData(e.menuData)):s(!1)},[()=>{var a;return(a=e.matchMenuKeys)==null?void 0:a.join("-")}]),i.useEffect(()=>{e.iconfontUrl&&(W=D.createFromIconfontCN({scriptUrl:e.iconfontUrl}))},[()=>e.iconfontUrl]);const b=i.useMemo(()=>Q(r.value,e),[()=>r.value&&r.value.join(","),()=>e.layout,()=>e.collapsed]),{wrapSSR:f,hashId:M}=z.useStyle(n,e.mode);return()=>{const{mode:a,location:c,collapsed:h,theme:S,postMenuData:p,menuData:C,menuProps:$,menuRenderType:K}=e,T=new J({...e,menuRenderType:K,location:i.isBrowser()?c||{pathname:window.location.pathname||"/"}:void 0,baseClassName:n.value,hashId:M.value}),g=p?p(C):C;return!g||g&&g.length<1?null:f(l.createVNode(G.Menu,l.mergeProps(b.value,$,{key:"Menu",mode:a,theme:S,inlineIndent:16,selectedKeys:y.value,items:T.getNavMenuItems(g,0,0),class:i.classNames(t.class,M.value,n.value,{[`${n.value}-collapsed`]:h}),onOpenChange:m=>{h||u(m)}}),null))}}});exports.baseMenuProps=q;exports.default=X;
